> 이 문서는 개발 중 발생한 이슈와 해결 과정을 기록한 문서입니다.  
> 날짜별로 정리하며, 문제 분석 및 느낀 점까지 작성합니다.

---

## 📅 2025-03-30 🧪 pqxx 종료 시 디버그 예외 발생 (_Rootnode nullptr)

- **문제**  
  Visual Studio 디버그 모드에서 `pqxx::connection::close()` 실행 시 `_Rootnode == nullptr` 예외 발생

- **원인 분석**  
  `libpqxx` 내부에서 `m_receivers.clear()` 수행 중, 디버그 STL 검사 기능이 잘못된 접근을 예외로 검출

- **시도한 해결법**  
  - [x] `txn.commit()` 위치 조정
  - [x] 트랜잭션 블록 내에서만 `pqxx::result` 사용
  - [x] `conn.close()` 호출 생략하여 예외 회피 (우회책)
  - [x] `optional<pqxx::result>` 사용 → 동일 예외 발생
  - [x] 결과를 `vector<tuple<...>>`에 복사 → 동일
  - [x] `/D_ITERATOR_DEBUG_LEVEL=0` 설정으로 STL 디버깅 무력화
  - [x] `libpqxx` 소스 코드에서 `m_receivers.clear()` 직접 확인
  - [x] `.c_str()` 호출 이후 바로 접근 제거

- **최종 해결 방법**  
  아직 미정. 릴리즈 모드에서는 발생하지 않음

- **관련 커밋**  
  `PostgreSQL 연결 테스트 코드 추가 릴리즈 모드 정상 작동, 디버그 모드 m_receivers.clear() 함수 작동 실패 상태`

- **느낀 점**  
  외부 라이브러리 사용 시 디버그 모드에서 발생하는 STL 관련 예외는 개발 환경 설정과도 밀접함을 느낌.  
  디버깅 환경에서의 예외 처리를 위한 사전 설정 중요성을 체감함.

---

## 📅 2025-03-31 🧪 한글 UTF-8 출력 깨짐 문제

- **문제**  
    Windows 콘솔에서 WebSocket 수신 메시지 중 한글이 깨진채로 "궔뤣줽..." 출력됨
    
- **원인 분석**  
    Windows 콘솔의 기본 코드페이지가 CP949(Korean ANSI)로 설정되어 있어 UTF-8 문자열을 제대로 출력하지 못함. 또한, `std::cout`은 wchar를 직접 다루기 어려워 한글 출력 시 깨짐 발생.
    
- **시도한 해결법**
    
- **최종 해결 방법**  
    위 3가지 모두 적용하여 해결됨. WebSocket으로 받은 한글 메시지가 콘솔에 정상적으로 출력됨.
    
- **관련 커밋**  
    `feat: 한글 지원 기능 추가 echo and add HTML client test page`
    
- **느낀 점**  
    콘솔 출력도 로컬 테스트에서 굉장히 중요하다. 특히 다국어 지원을 고려할 경우, 출력 코드페이지와 출력 스트림 타입(`wcout`)을 명확히 이해해야 함.
    UTF-8은 진짜....너무하다...... 미국인 하고 싶다 그냥...

---

# 📅 2025-04-03 🧪 Visual Studio 소스 내 한글 문자열 오류

- **문제**  
    Visual Studio 2022에서 Boost.Beast 코드 내 람다 함수에 한글 문자열이 포함된 경우  
    "상수에 줄 바꿈 문자가 있습니다", "일치하는 토큰을 찾을 수 없습니다" 컴파일 오류 발생.

- **원인 분석**  
    Visual Studio의 C++ 컴파일러가 특정 인코딩(EUC-KR/CP949)으로 저장된 파일의 한글 문자열을 처리하는 과정에서 문제 발생.  
    특히 람다 함수 내에서 `L"[Server] 새 클라이언트 연결 수락됨"` 같은 한글 문자열이 포함된 경우  
    컴파일러가 줄바꿈으로 잘못 인식함.

- **시도한 해결법**
	- [x]  코드 재구성 및 줄바꿈 제거
	- [x]  람다 함수 분리 및 간소화
	- [x]  Visual Studio 재시작
	- [x]  프로젝트 설정에서 문자 집합 옵션 변경
	- [x]  새 파일 생성 후 코드 복사
	- [x]  다른 인코딩으로 저장 시도 (UTF-8 with BOM)

- **최종 해결 방법**  
    파일을 **유니코드(서명 없는 UTF-8)** 인코딩으로 저장하여 문제 해결.  
    Visual Studio의 **파일 저장 옵션**에서 인코딩 설정을 명시적으로 변경함.  
    추가로 프로젝트 전체에 일관된 인코딩을 적용하기 위해 `.editorconfig` 활용 예정.

- **관련 커밋**  
    `fix: Server Korean Encoding`

- **느낀 점**  
    한글 인코딩은 정말 복잡한 문제였다.  
    Visual Studio에서 C++ 코드의 인코딩 처리 방식이 상당히 까다로웠다.  
    이로 인해 `.editorconfig` 파일의 중요성을 알게 되었고,  
    협업 시 이런 기본 설정을 **명확히 정의**하는 것이 얼마나 중요한지 체감했다.  
    인코딩 변환에 의존하기보다는 **명시적으로 UTF-8을 지정하는 습관**을 들이기로 했다